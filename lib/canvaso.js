/*
	Header Animation by Thomas Dubosc,
	http://repraze.com
*/
function randomIntFromInterval(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function Canvas(e){this.canvas=document.getElementById(e);this.context=this.canvas.getContext("2d");this.getWidth=function(){return this.canvas.width};this.getHeight=function(){return this.canvas.height};this.setWidth=function(e){if(e==this.canvas.width)return;this.canvas.width=e};this.setHeight=function(e){if(e==this.canvas.height)return;this.canvas.height=e}}function Position(e,t){this.x=e;this.y=t;this.getCopy=function(){return new Position(this.x,this.y)};this.add=function(e){this.x+=e.x;this.y+=e.y;return this};this.remove=function(e){this.x-=e.x;this.y-=e.y;return this};this.equals=function(e){if(this.x==e.x&&this.y==e.y){return true}return false};this.factor=function(e){this.x*=e;this.y*=e;return this};this.between=function(e,t){return this.getCopy().add(e.getCopy().remove(this).factor(t))};this.sqDistanceTo=function(e){var t=this.x-e.x;var n=this.y-e.y;return t*t+n*n};this.getLength=function(){return Math.sqrt(this.y*this.y+this.x*this.x)};this.getAngle=function(){return Math.atan2(this.y,this.x)}}function Vector(e,t){this.velocity=e;this.angle=t;this.getPosition=function(){return new Position(Math.cos(this.angle)*this.velocity,Math.sin(this.angle)*this.velocity)};this.getCopy=function(){return new Vector(this.velocity,this.angle)};this.add=function(e){var t=this.getPosition();t.add(e.getPosition());this.velocity=t.getLength();this.angle=t.getAngle();return this};this.remove=function(e){var t=this.getPosition();t.remove(e.getPosition());this.velocity=t.getLength();this.angle=t.getAngle();return this};this.getProjectionVelocity=function(e){var t=this.getCopy();t.angle-=e;return Math.cos(t.angle)*t.velocity}}function HeaderAnimation(e,t){this.canvas=new Canvas(e);this.container=document.getElementById(t);this.canvas.setWidth(this.container.offsetWidth);this.canvas.setHeight(this.container.offsetHeight);this.animation=new ActiveGraph(this.canvas);var n=this;requestAnimationFrame(function(e){n.run(e)});this.run=function(e){var t=this;if(!this.lastFrameDate){this.lastFrameDate=e}else{if(this.canvas.getWidth()!=this.container.offsetWidth||this.canvas.getHeight()!=this.container.offsetHeight){this.canvas.setWidth(this.container.offsetWidth);this.canvas.setHeight(this.container.offsetHeight);this.animation=new ActiveGraph(this.canvas)}if(document.body.scrollTop<this.container.offsetHeight+this.container.offsetTop){var n=Math.min(.05,(e-this.lastFrameDate)/1e3);this.update(n);this.render(this.canvas.context)}this.lastFrameDate=e}requestAnimationFrame(function(e){t.run(e)})};this.update=function(e){this.animation.update(e)};this.render=function(e){e.save;e.clearRect(0,0,this.canvas.getWidth(),this.canvas.getHeight());this.animation.render(e);e.restore()}}function ActiveGraph(e){this.nodes=new Array;this.edges=new Array;this.canvas=e;this.width=this.canvas.getWidth();this.height=this.canvas.getHeight();this.nb=Math.min(this.canvas.getWidth()/10,140);this.near=2;for(var t=0;t<this.nb;t++){this.nodes.push(new Node(this,new Position(randomIntFromInterval(0,this.canvas.getWidth()),randomIntFromInterval(0,this.canvas.getHeight()))))}this.hasEdge=function(e){for(var t=0;t<this.edges.length;t++){if(e.equals(this.edges[t]))return true}return false};this.addEdge=function(e){if(!this.hasEdge(e)){this.edges.push(e)}};this.update=function(e){this.width=this.canvas.getWidth();this.height=this.canvas.getHeight();for(var t=0;t<this.nodes.length;t++){this.nodes[t].update(e)}this.edges=new Array;var n=this.nodes.slice();for(var t=0;t<this.nodes.length;t++){var r=this.nodes[t].position;n.sort(function(e,t){return e.position.sqDistanceTo(r)-t.position.sqDistanceTo(r)});for(var i=1;i<this.near+1;i++){this.addEdge(new Edge(this,this.nodes[t],n[i]))}}};this.render=function(e){for(var t=0;t<this.edges.length;t++){this.edges[t].render(e)}for(var t=0;t<this.nodes.length;t++){this.nodes[t].render(e)}}}function Node(e,t){this.graph=e;this.position=t||new Position(0,0);this.speed=randomIntFromInterval(.1,15);this.direction=randomIntFromInterval(0,2*Math.PI);this.vector=new Vector(randomIntFromInterval(.1,15),randomIntFromInterval(0,2*Math.PI));this.equals=function(e){return this.position.equals(e.position)};this.update=function(e){this.position.add(this.vector.getPosition().factor(e));if(this.position.x<0){this.position.x+=this.graph.width}else if(this.position.x>this.graph.width){this.position.x-=this.graph.width}if(this.position.y<0){this.position.y+=this.graph.height}else if(this.position.y>this.graph.height){this.position.y-=this.graph.height}};this.render=function(e){e.beginPath();e.arc(this.position.x,this.position.y,4,0,2*Math.PI,false);e.lineWidth=2;e.fillStyle="#0490d3";e.strokeStyle="#ffffff";e.fill();e.stroke()}}function Edge(e,t,n){this.graph=e;this.nodeA=t;this.nodeB=n;this.equals=function(e){return this.nodeA.position.equals(e.nodeA.position)&&this.nodeB.position.equals(e.nodeB.position)||this.nodeA.position.equals(e.nodeB.position)&&this.nodeB.position.equals(e.nodeA.position)};this.update=function(e){};this.length=function(){return this.nodeA.position.sqDistanceTo(this.nodeB.position)};this.angle=function(){return Math.atan2(this.nodeA.position.y-this.nodeB.position.y,this.nodeA.position.x-this.nodeB.position.x)};this.render=function(e){var t=1-this.length()/1e4;if(t<.1){t=.1}e.strokeStyle="rgba(255,255,255,"+t+")";e.beginPath();e.moveTo(this.nodeA.position.x,this.nodeA.position.y);e.lineTo(this.nodeB.position.x,this.nodeB.position.y);e.stroke()}}jQuery(document).ready(function(){new HeaderAnimation("canvas","header")})